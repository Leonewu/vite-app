# 业绩大屏

一个实时的数据大屏页面

## 需求描述

1. 左右滚动的实时数据表格，可自动滚动和手动点击滚动
2. 倒计时组件设计，需考虑降频
3. 实时记录滚动组件，新的记录会不断的顶走旧记录，最多展示 5 条记录
4. 烟火 canvas 特效
5. 手写弹窗，需要使用 portal
6. 可配置的区域背景颜色
7. 鼠标不移动 15s 后，自动隐藏鼠标
8. 支持全屏展示，鼠标移动后，右上角滑出全屏按钮，否则隐藏

## 考虑的问题

1. react hooks 版本的定时器实现。
2. 倒计时组件设计，api 设计尽量简单明了。并且需要考虑浏览器切换窗口之后会导致倒计时不准确的问题。通过监听浏览器的事件暂停和恢复倒计时。
3. 滚动表格的设计
   1. 使用两个表格，一个展示表头，一个展示表格内容（布局使用 table-layout: fixed 即不用默认布局算法渲染（列宽会取内容宽度最大的宽度），默认为 auto）使用 colgroup 进行列宽的统一限制。
   2. 基于 antd carousel 组件封装，该组件是基于 react-slick 封装，由于没有异步 api，同时要满足实时滚动。所以需要暴露出来一个获取数据的异步函数，使请求和交互可控。
   3. 其他的 api 设计参考 antd table，尽量对齐。
4. 实时记录滚动组件，通过 css 动画实现，但前提是每一列的宽度需要固定，api 设计时需要支持 render props。
5. 烟火特效，通过在修改网上找到的例子，封装成 react 组件。
6. 手写弹窗，弹窗一般都是用 portal 来编写，需要考虑弹窗的动画，外部滚动条的影响。
7. 背景颜色定制，通过 css 变量实现。
8. 鼠标不移动自动隐藏，需要不移动 15s 隐藏，需要防抖，同时鼠标移动的事件也需要节流，最终，给对应元素添加 cursor: none !important 的属性。
9. 全屏通过 ahook 的 useFullscreen 实现，因为不复杂，所以就懒得去踩坑了。鼠标移动全屏按钮的显隐实现思路和第 8 点类似。

## 总结

1. 做好定时器的维护
2. 设计 api 时，尽量简单明了，一目了然，多参考 antd 的 api 设计和命名

以上组件在 src/components 目录下可找到
